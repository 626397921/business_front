# 重新实现全选和反选功能

## 问题分析
用户反馈全选所有页码的数据和反选功能都没有实现，通过分析代码，我发现以下问题：

1. **全选所有页码的数据**：当前实现只选中了当前页的记录，而不是所有页的记录
2. **反选功能**：反选逻辑没有正确实现，当用户点击选中的记录后，再点击全选，没有选中除了之前点击的记录之外的所有数据

## 修复计划

### 1. 重新实现全选功能
- 修改 `handleSelectAll` 函数，确保点击全选时能选中所有页的记录
- 实现全选状态的正确管理
- 添加逻辑以确保全选功能能覆盖所有页码的数据

### 2. 重新实现反选功能
- 在 `handleSelectAll` 函数中重新实现反选逻辑
- 确保当用户点击选中的记录后，再点击全选，会选中除了之前点击的记录之外的所有数据
- 正确处理反选后的状态更新

### 3. 优化选中状态管理
- 确保 `totalSelectedIds` 正确存储所有页的选中记录ID
- 确保 `currentPageSelectedIds` 正确存储当前页的选中记录ID
- 优化 `updateSelectionStatus` 函数，确保选中状态正确更新

### 4. 优化状态恢复
- 优化 `restoreCurrentPageSelection` 函数，确保在切换页码时正确恢复选中状态
- 确保在数据加载后正确恢复选中状态

### 5. 测试验证
- 测试全选功能：点击全选，验证是否选中所有页的记录
- 测试反选功能：选中部分记录后点击全选，验证是否选中除已选中记录外的所有记录
- 测试跨页选中：在不同页码之间切换，验证选中记录是否保持
- 测试分页操作：切换页码和改变每页显示数量，验证选中状态是否保持

## 技术实现要点
- 使用 `Set` 类型存储选中的记录ID，确保唯一性
- 利用 Element Plus 的 `reserve-selection` 属性实现跨页选中
- 在表格的 `select-all` 事件中实现全选和反选逻辑
- 确保在数据加载后，根据 `totalSelectedIds` 恢复选中状态
- 正确处理各种边界情况，确保功能的稳定性

通过以上修复，确保全选和反选功能能够正确实现，满足用户的需求。